<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="color-scheme" content="light dark">
  
  
  

  <title>Make work in Windows on Mac a joy</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  
  <style>

  /* light mode colors */
  body {
    --primary-color: #5871a2;
    --primary-pale-color: #5871a210;
    --text-color: #3C4043;
    --text-pale-color: #a3a5a9;
    --bg-color: #ffffff;
    --highlight-mark-color: #5f75b035;
    --blockquote-color: #8e8d91;

    --callout-note-color: #5871a2;
    --callout-important-color: #8062b0;
    --callout-warning-color: #936e51;
    --callout-alert-color: #bc5252;
    --callout-question-color: #477389;
    --callout-tip-color: #3c8460;
  }

  /* dark mode colors */
  body.dark {
    --primary-color: #5d77ac;
    --primary-pale-color: #5d77ac20;
    --text-color: #9197a5;
    --text-pale-color: #656a74;
    --bg-color: #18191b;
    --highlight-mark-color: #5f75b035;
    --blockquote-color: #747983;

    --callout-note-color: #5d77ac;
    --callout-important-color: #8062b0;
    --callout-warning-color: #936e51;
    --callout-alert-color: #bc5252;
    --callout-question-color: #477389;
    --callout-tip-color: #3c8460;
  }

  /* typography */
  body {
    --main-font: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    --code-font: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    --homepage-max-width: 768px;
    --main-max-width: 768px;
    --avatar-size: 56px;
    --homepage-font-size: 16px;
    --homepage-line-height: 1.75;
    --paragraph-font-size: 16px;
    --paragraph-line-height: 1.75;
    --aside-font-size: 15px;
    --img-border-radius: 0px;
    --detail-border-radius: 0px;
    --dark-mode-img-brightness: 0.75;
    --dark-mode-chart-brightness: 0.75;
    --inline-code-border-radius: 2px;
    --inline-code-bg-color: var(--primary-pale-color);
    --block-code-border-radius: 0px;
    --block-code-border-color: var(--primary-color);
    --detail-border-color: var(--primary-color);
  }

</style>

  <link rel="stylesheet" href="/main.css">
  

<link id="hl" rel="stylesheet" type="text/css" href="/hl-light.css" />



  
</head>

<body class="post">
  
  <script>
    const theme = sessionStorage.getItem('theme');
    const match = window.matchMedia("(prefers-color-scheme: dark)").matches
    if ((theme && theme == 'dark') || (!theme && match)) {
      document.body.classList.add('dark');
      const hl = document.querySelector('link#hl');
      if (hl) hl.href = '/hl-dark.css';
    }
  </script>
  
  
<header >
  <div id="header-wrapper">
    <nav>
      <a class="instant" href="/">vors.me</a>
      
        <button id="toggler" class="separator" aria-label="toggle expand">&gt;</button>
      
      
        <span class="wrap left fold">{</span>
        
        
        
        
          
          
          <a class="instant " href="&#x2F;posts">posts</a>
          <span class="wrap-separator fold">,</span>
        
          
          
            
          
          <a class="instant fold" href="&#x2F;projects">projects</a>
          
        
        <span class="wrap right fold">} ;</span>
      
    </nav>
    <div id="btns">
      
      
      

      
      
      
      
      

      
      
      
      <button id="theme-toggle" aria-label="theme switch">
        <span class="moon-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M10 7C10 10.866 13.134 14 17 14C18.9584 14 20.729 13.1957 21.9995 11.8995C22 11.933 22 11.9665 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C12.0335 2 12.067 2 12.1005 2.00049C10.8043 3.27098 10 5.04157 10 7ZM4 12C4 16.4183 7.58172 20 12 20C15.0583 20 17.7158 18.2839 19.062 15.7621C18.3945 15.9187 17.7035 16 17 16C12.0294 16 8 11.9706 8 7C8 6.29648 8.08133 5.60547 8.2379 4.938C5.71611 6.28423 4 8.9417 4 12Z" fill="currentColor"></path></svg></span>
        <span class="sun-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M12 18C8.68629 18 6 15.3137 6 12C6 8.68629 8.68629 6 12 6C15.3137 6 18 8.68629 18 12C18 15.3137 15.3137 18 12 18ZM12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16ZM11 1H13V4H11V1ZM11 20H13V23H11V20ZM3.51472 4.92893L4.92893 3.51472L7.05025 5.63604L5.63604 7.05025L3.51472 4.92893ZM16.9497 18.364L18.364 16.9497L20.4853 19.0711L19.0711 20.4853L16.9497 18.364ZM19.0711 3.51472L20.4853 4.92893L18.364 7.05025L16.9497 5.63604L19.0711 3.51472ZM5.63604 16.9497L7.05025 18.364L4.92893 20.4853L3.51472 19.0711L5.63604 16.9497ZM23 11V13H20V11H23ZM4 11V13H1V11H4Z" fill="currentColor"></path></svg></span>
      </button>
      

      
      
      
      
      
    </div>
  </div>
</header>





<div id="wrapper">
  <div id="blank"></div>
  <aside>
    
    
    
  </aside>
  <main>
    <div>
      
      
      
      
      <div id="copy-cfg" style="display: none;" data-copy-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;20&quot; height=&quot;20&quot;&gt;&lt;path d=&quot;M6.9998 6V3C6.9998 2.44772 7.44752 2 7.9998 2H19.9998C20.5521 2 20.9998 2.44772 20.9998 3V17C20.9998 17.5523 20.5521 18 19.9998 18H16.9998V20.9991C16.9998 21.5519 16.5499 22 15.993 22H4.00666C3.45059 22 3 21.5554 3 20.9991L3.0026 7.00087C3.0027 6.44811 3.45264 6 4.00942 6H6.9998ZM5.00242 8L5.00019 20H14.9998V8H5.00242ZM8.9998 6H16.9998V16H18.9998V4H8.9998V6Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;" data-check-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;20&quot; height=&quot;20&quot;&gt;&lt;path d=&quot;M10.0007 15.1709L19.1931 5.97852L20.6073 7.39273L10.0007 17.9993L3.63672 11.6354L5.05093 10.2212L10.0007 15.1709Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;"></div>
      
      
      <article class="prose" data-backlink-icon="&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;20&quot; height=&quot;20&quot;&gt;&lt;path d=&quot;M9.41421 8L18.0208 16.6066L16.6066 18.0208L8 9.41421V17H6V6H17V8H9.41421Z&quot; fill=&quot;currentColor&quot;&gt;&lt;&#x2F;path&gt;&lt;&#x2F;svg&gt;">
        <h1>Make work in Windows on Mac a joy</h1>
        <div id="post-info">
          <div id="date">
            <span id="publish">2015-06-21</span>
            </div>

          

          
        </div>

        
        

        

        

        
          <h2 id="preambula">Preambula<a class="zola-anchor" href="#preambula" aria-label="Anchor link for: preambula" style="visibility: hidden;"></a>
</h2>
<p>My old MacBook Air pass out, so I got a new <a rel="nofollow noreferrer" href="https://www.apple.com/macbook/">MacBook</a> a week ago.
I never feel need in virtualization to play games or do something else on my old MacBook.
I had my transparent <strong>terminal</strong> to play with new cool stuff, my chrome <strong>browser</strong> with smooth two-finger scroll,
<strong>iMovie</strong> to ocasionally make clips and that was about everything I ever used.</p>
<p>Since I work almost 3 years at Microsoft, I acquired some taste for Windows systems.
And when <a rel="nofollow noreferrer" href="https://twitter.com/BrucePayette">Bruce</a> asked me when I'm going to run <strong>PowerShell</strong> on my new laptop,
I thought it would be cool to install <strong>Windows 10 preview</strong> as a second system.
I had no idea what is <a rel="nofollow noreferrer" href="http://www.apple.com/support/bootcamp/">bootcamp</a> and even was not sure is it possible to have two systems on Apple's hardware.
Advantures time!</p>
<p><strong>Disclamer</strong>: I was not able to install Windows 10.
I know that <a rel="nofollow noreferrer" href="http://www.pcworld.com/article/2824227/how-to-install-the-windows-10-technical-preview-on-a-mac.html">it's possible</a>.
I cannot figure out how to install bootcamp drivers for trackpad and keyboard for <strong>installation stage</strong>.
I cannot go further then language select screen. Instead, I run Windows 8.1 now.</p>
<p>I don't have any disire to describe this somwhat straigforward process of bootcamp installation.
It still requires a lot of googling and retries, but there is nothing interesting about it.</p>
<p>What is interesting is the fact that once I start playing around with Windows 8.1 on Mac hardware
(by hardware I primerely mean keyboard and trackpad as well as retina display),
I quickly reilize that it's <strong>ass</strong>.</p>
<p>Don't get me wrong: I actually like Windows 8.1 (and Windows 10 preview looks even better, except stability).
But it just feels soooo wrooong on MacBook.
Keyboard shortcuts, trackpad momentum, brighness control.
<strong>Nothing just work</strong> as expected.
That's why I defined an <strong>Uber Goal</strong>: make Windows expirience as close to OS X as possible.</p>
<h2 id="my-receipe-to-make-windows-on-mac-a-joy">My receipe to make Windows on Mac a joy<a class="zola-anchor" href="#my-receipe-to-make-windows-on-mac-a-joy" aria-label="Anchor link for: my-receipe-to-make-windows-on-mac-a-joy" style="visibility: hidden;"></a>
</h2>
<h1 id="short-cuts">Short cuts<a class="zola-anchor" href="#short-cuts" aria-label="Anchor link for: short-cuts" style="visibility: hidden;"></a>
</h1>
<p><strong>Goal</strong>: rebind keyboard to use standart Mac shortcuts.</p>
<p>After installing Windows on Mac via bootcamp, <em><strong>Command</strong></em> ("⌘") key becomes <em><strong>Win</strong></em> key.
It totally makes sense ... for somebody who never work on Mac.
Most essential Mac short cuts (copy / paste, close program, change keyboard layout) use "⌘".</p>
<p>First requirement: <strong>rebind <em>Win</em> key to <em>Left Ctrl</em> key</strong>.</p>
<p>It's possible to do with <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout\ScancodeMap</code> registry key.</p>
<p><img src="/images/WindowsOnMac/RegistryScancodeMap.png" alt="Registry entry for ScancodeMap" /></p>
<p>The date format is somewhat straighforward, but it's binary and uses keys hex identifiers.
It's much easier to use <a rel="nofollow noreferrer" href="https://github.com/randyrants/sharpkeys">SharpKeys</a> utility to do math and edit registry for you.</p>
<p>I recommend <strong>swap</strong> <em>Left Ctrl</em> and <em>Win</em> key (add the second entry), because <em>Win</em> is part of some useful short cuts itself.
It also bring start screen and I use it all the time for applications quick lunch.</p>
<p><img src="/images/WindowsOnMac/SharpKeysBinding.png" alt="SharpKeys binding" /></p>
<p>We are already in a pretty good shape:</p>
<ul>
<li>"⌘" <code>C</code> / "⌘" <code>V</code> (copy / paste).</li>
<li>"⌘" <code>1</code> / "⌘" <code>2</code> / "⌘" <code>3</code> (to select tab in a browser).</li>
<li>"⌘" <code>W</code> (to close tab).</li>
</ul>
<p>already work as expected.</p>
<h1 id="better-short-cuts">Better short cuts<a class="zola-anchor" href="#better-short-cuts" aria-label="Anchor link for: better-short-cuts" style="visibility: hidden;"></a>
</h1>
<p>One thing that I found extremely annoying is <code>Alt</code> <code>Tab</code>.
I want it to be the same as OS X: "⌘" <code>Tab</code>.
But I cannot achive it with the same registry trick: it would conflict with my existing binding.
We need a way to rebind <strong>combinations</strong>.</p>
<p>I found the solution in <a rel="nofollow noreferrer" href="https://www.autohotkey.com/">AutoHotKey</a>.
I was particularly interested to try it out, since one of their tag-lines is "Fast scriptable desktop automation with hotkeys" (khm khm PowerShell).</p>
<p>It's also an <a rel="nofollow noreferrer" href="https://github.com/AutoHotkey/AutoHotkey">open source project</a> with GPL license and <a rel="nofollow noreferrer" href="https://github.com/ahkscript">community</a>,
pretty <a rel="nofollow noreferrer" href="https://www.autohotkey.com/">modern-looking website</a>,
<a rel="nofollow noreferrer" href="https://github.com/ahkscript/SublimeAutoHotkey">sublime-text plugin</a>,
<a rel="nofollow noreferrer" href="https://www.autohotkey.com/docs/v1/Hotkeys.htm">solid documentation</a>;
it doesn't bag for donations (in fact there is no option for donate as far as I know).
Not your archetypal <a rel="nofollow noreferrer" href="http://trackpad.powerplan7.com/">Windows ecosystem helper application</a>.</p>
<p>I wrote this simple <code>.ahk</code> script to remap <code>Alt</code> <code>Tab</code> and <code>Alt</code> <code>F4</code></p>
<pre class="z-code"><code><span class="z-text z-plain">; &#39;Command&#39; remapped to &#39;Left Control&#39; in Registry
</span><span class="z-text z-plain">; https://sharpkeys.codeplex.com/
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">; Remap &#39;Command&#39; + &#39;Tab&#39; to be &#39;Alt&#39; + &#39;Tab&#39;
</span><span class="z-text z-plain">; this line require &#39;Run with UI Access&#39;: 
</span><span class="z-text z-plain">; https://www.autohotkey.com/board/topic/70449-enable-interaction-with-administrative-programs/
</span><span class="z-text z-plain">LControl &amp; Tab::AltTab 
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">; Remap &#39;Command&#39; + &#39;Q&#39; to &#39;Alt&#39; + &#39;F4&#39;
</span><span class="z-text z-plain">LControl &amp; q::Send !{f4}
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">; Remap &#39;Command&#39; + &#39;Space&#39; to &#39;Win&#39; + &#39;Space&#39; 
</span><span class="z-text z-plain">; Change language layout in Win 10
</span><span class="z-text z-plain">LControl &amp; Space::Send #{Space}
</span></code></pre>
<p>It turns out that to rebind <code>Alt</code> <code>Tab</code> on Windows 8.1 you need <a rel="nofollow noreferrer" href="https://www.autohotkey.com/board/topic/70449-enable-interaction-with-administrative-programs/">a little bit more ceremony</a>.
Once you done with <em>patching AutoHotKey.exe with AutoHotKey.exe</em>,
you can create a <code>.lnk</code> file in your <code>~\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</code> directory to automatically run script on the system startup.</p>
<p><strong>UPD:</strong> Use <code>C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp</code> directory to enable it for all users.</p>
<p>On my system "Target" is <code>"C:\Program Files\AutoHotkey\AutoHotkey.exe" C:\dev\AutoHotkey\WindowsOnMac.ahk</code></p>
<p><img src="/images/WindowsOnMac/AutoHotKeyLnk.png" alt="AutoHotkey lnk property" /></p>
<p><strong>Voilà!</strong> Feel free to customize more key combinations.</p>
<p><strong>UPD:</strong> I created <a rel="nofollow noreferrer" href="https://github.com/vors/AutoHotKey-Mac">the repo</a> with all code related to AutoHotKey setup.</p>
<h1 id="brightness">Brightness<a class="zola-anchor" href="#brightness" aria-label="Anchor link for: brightness" style="visibility: hidden;"></a>
</h1>
<p>Windows auto-adjustive brightness doesn't play nicely with manual brightness adjustion.
It makes everything look pretty <strong>dim</strong>.
Just <strong><a rel="nofollow noreferrer" href="https://discussions.apple.com/thread/4073073?tstart=0">turn auto-brightness off</a></strong>.</p>
<h1 id="better-trackpad">Better trackpad<a class="zola-anchor" href="#better-trackpad" aria-label="Anchor link for: better-trackpad" style="visibility: hidden;"></a>
</h1>
<p>It's a little bit painful to install <a rel="nofollow noreferrer" href="http://trackpad.powerplan7.com/">TrackPad++</a> (especially read Web-1.0-site),
but it adds <strong>innertial movement</strong> to trackpad two-finger scroll.
So I cosider it worth mentioning.
Just be awere that it doesn't fully work in Google chrome (only Firefox and IE 11), which is Google's fault.
I found that IE 11 with TrackPad++ provides pretty good scrolling expirience. Not as good as native Apple's Safari, but a decient one.</p>
<p><strong>Update:</strong>
I take back my recomendation for <strong>TrackPad++</strong>.
It's cumbersome, annoying and doesn't provide much value.
All you really need is a way to <a rel="nofollow noreferrer" href="http://superuser.com/questions/310681/inverting-direction-of-mouse-scroll-wheel"><strong>reverse trackpad scrolling direction</strong></a></p>
<pre class="z-code"><code><span class="z-text z-plain">Get-ItemProperty HKLM:\SYSTEM\CurrentControlSet\Enum\HID\*\*\Device` Parameters FlipFlopWheel -EA 0 | ForEach-Object { Set-ItemProperty $_.PSPath FlipFlopWheel 1 }
</span></code></pre>
<h2 id="conclusion">Conclusion<a class="zola-anchor" href="#conclusion" aria-label="Anchor link for: conclusion" style="visibility: hidden;"></a>
</h2>
<p>Know your tools and make your work <strong>enjoyable</strong>.</p>

        
      </article>

      
      

      
      
    </div>

    <footer>
  <div class="copyright">
    
  </div>
  
</footer>
  </main>
</div>

  
<script src="/js/lightense.min.js"></script>


  <script src="/js/main.js"></script>
</body>

</html>
